# App Sequence Diagram (Who talks to who?)

```mermaid
sequenceDiagram
    autonumber
    participant User as ðŸ‘¤ User
    participant Frontend as ðŸ–¥ï¸ Frontend (public/js)
    participant Middleware as ðŸ›¡ï¸ Middleware (The Bouncer)
    participant Controller as ðŸ¤µ Controller (The Waiter)
    participant Repo as ðŸ“š Repository (The Librarian)
    participant DB as ðŸ’½ Database (SQLite)

    Note over User, Frontend: Phase 1: The Order
    User->>Frontend: Clicks "Book Room"
    Frontend->>Frontend: Checks localStorage<br/>(Finds "Wristband" UserID: 5)
    Frontend->>Middleware: POST /api/bookings<br/>Headers: { user-id: 5 }

    Note over Middleware, Controller: Phase 2: Security Check
    Middleware->>Middleware: Checks Headers for "user-id"
    alt No Wristband?
        Middleware-->>Frontend: 401 Unauthorized â›”
    else Has Wristband
        Middleware->>Controller: next() âœ…
    end

    Note over Controller, DB: Phase 3: Processing
    Controller->>Repo: createBooking(roomId, userId...)
    Repo->>DB: INSERT INTO bookings...
    DB-->>Repo: Success (Row ID: 42)
    Repo-->>Controller: Returns Result

    Note over Controller, User: Phase 4: Response
    Controller-->>Frontend: 201 Created (JSON)
    Frontend->>User: Alert("Booking Confirmed! ðŸŽ‰")
    Frontend->>Frontend: Reloads Room List
```

# The Architecture Diagram (Physical Structure)

```mermaid
graph TD
    subgraph Client ["ðŸ½ï¸ Dining Room (Frontend)"]
        User((ðŸ‘¤ User))
        Browser["ðŸ–¥ï¸ Browser / public/"]
        LS[("Wristband / localStorage")]
    end

    subgraph Server ["The Kitchen (Backend)"]
        App["âš™ï¸ App.js / Server.js"]
        
        subgraph Logic ["The Staff"]
            MW["ðŸ›¡ï¸ Middleware"]
            Route["ðŸ“œ Routes"]
            Ctrl["ðŸ¤µ Controllers"]
            Repo["ðŸ“š Repositories"]
        end
        
        DB[("ðŸ’½ SQLite Database")]
    end

    %% Connections
    User -- Clicks Button --> Browser
    Browser -- 1. Reads --> LS
    Browser -- 2. Sends HTTP Request --> App
    
    App --> Route
    Route --> MW
    MW --> Ctrl
    Ctrl -- Asks for Data --> Repo
    Repo -- SQL Query --> DB
    
    DB -- Raw Data --> Repo
    Repo -- Data --> Ctrl
    Ctrl -- JSON Response --> Browser
    Browser -- Updates UI --> User
```
